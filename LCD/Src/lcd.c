/*
 * lcd.c
 *
 *  Created on: Feb 5, 2020
 *      Author: igor.dymov
 */
#include "lcd.h"
#include "main.h"

#include "u8g2.h"

#include "server.h"
#include "rtc.h"


#define home18_width 18
#define home18_height 18
static unsigned char home18_bits[] = {
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x80, 0x04, 0x00,
   0x40, 0x08, 0x00, 0x20, 0x10, 0x00, 0x10, 0x20, 0x00, 0x00, 0x00, 0x00,
   0x04, 0x80, 0x00, 0x86, 0x87, 0x01, 0x80, 0x04, 0x00, 0x80, 0x04, 0x00,
   0x80, 0x04, 0x00, 0x80, 0x04, 0x00, 0xc8, 0x4c, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };


#define icons8_width 20
#define icons8_height 20
static unsigned char icons8_bits[] = {
   0x00, 0x00, 0x00, 0x00, 0x0f, 0x00, 0x00, 0x09, 0x00, 0x38, 0xc9, 0x01,
   0xc8, 0x30, 0x01, 0x08, 0x00, 0x01, 0x10, 0x80, 0x00, 0x10, 0x8f, 0x00,
   0x8e, 0x10, 0x07, 0x82, 0x10, 0x04, 0x82, 0x10, 0x04, 0x8e, 0x10, 0x07,
   0x10, 0x8f, 0x00, 0x10, 0x80, 0x00, 0x08, 0x00, 0x01, 0xc8, 0x30, 0x01,
   0x38, 0xc9, 0x01, 0x00, 0x09, 0x00, 0x00, 0x0f, 0x00, 0x00, 0x00, 0x00 };

static unsigned char icons8_1_bits[] = {
   0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x07, 0x00, 0x40, 0x06,
   0x00, 0x20, 0x00, 0x00, 0x10, 0x01, 0x00, 0x88, 0x00, 0x00, 0x44, 0x00,
   0x00, 0x22, 0x00, 0x00, 0x11, 0x00, 0x80, 0x08, 0x00, 0x40, 0x04, 0x00,
   0x20, 0x02, 0x00, 0x10, 0x01, 0x00, 0x88, 0x00, 0x00, 0x44, 0x00, 0x00,
   0x26, 0x00, 0x00, 0x1e, 0x00, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x00, 0x00 };
static unsigned char icons8_2_bits[] = {
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0x30, 0x00,
   0xa0, 0x59, 0x00, 0x30, 0xcf, 0x00, 0x0c, 0x00, 0x03, 0x04, 0x00, 0x02,
   0x06, 0x00, 0x06, 0x7e, 0xe0, 0x07, 0xc6, 0x30, 0x06, 0x83, 0x1f, 0x0c,
   0x81, 0x19, 0x08, 0x81, 0x1f, 0x08, 0x83, 0x19, 0x0c, 0xc2, 0x30, 0x04,
   0x7c, 0xe0, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };

static unsigned char home_bits[] = {
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x0f, 0x00,
   0x80, 0x19, 0x00, 0xc0, 0x30, 0x00, 0x60, 0x60, 0x00, 0x30, 0xc0, 0x00,
   0x08, 0x00, 0x01, 0x0c, 0x00, 0x03, 0x8e, 0x1f, 0x07, 0x88, 0x19, 0x01,
   0x88, 0x19, 0x01, 0x88, 0x19, 0x01, 0x88, 0x19, 0x01, 0x88, 0x19, 0x01,
   0xf8, 0xf9, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };

static unsigned char fold_bits[] = {
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x61, 0x00, 0x00, 0xc1, 0xff, 0x03,
   0x01, 0x00, 0x04, 0x01, 0x00, 0x04, 0x05, 0x00, 0x08, 0x05, 0x00, 0x08,
   0x05, 0x00, 0x08, 0x03, 0x00, 0x00, 0x03, 0x00, 0x00, 0x03, 0x00, 0x04,
   0x03, 0x00, 0x04, 0x03, 0x00, 0x04, 0x01, 0x00, 0x04, 0x01, 0x00, 0x00,
   0x01, 0x00, 0x02, 0x01, 0x00, 0x02, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00 };

static unsigned char fac_bits[] = {
   0x00, 0x00, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x20, 0x0e, 0x00, 0x70, 0x07,
   0x00, 0x70, 0x03, 0x00, 0x38, 0x00, 0x00, 0x80, 0x03, 0x00, 0x38, 0x03,
   0x00, 0x98, 0x03, 0xff, 0x19, 0x03, 0x93, 0x19, 0x03, 0x11, 0x19, 0x03,
   0x11, 0x19, 0x03, 0x11, 0xff, 0x03, 0xff, 0xff, 0x03, 0xff, 0xbd, 0x03,
   0x11, 0xbd, 0x07, 0x93, 0xff, 0x07, 0xff, 0xff, 0x07, 0x00, 0x00, 0x00 };

static unsigned char akk_bits[] = {
   0xf8, 0xf0, 0x01, 0xfc, 0xf9, 0x03, 0x8c, 0x19, 0x03, 0x8c, 0x19, 0x03,
   0xff, 0xff, 0x0f, 0x03, 0x00, 0x0c, 0x03, 0x00, 0x0c, 0x63, 0x00, 0x0c,
   0xf3, 0xf0, 0x0c, 0xf3, 0xf0, 0x0c, 0x63, 0x00, 0x0c, 0x03, 0x00, 0x0c,
   0x03, 0x00, 0x0c, 0x03, 0x00, 0x0c, 0x03, 0x00, 0x0c, 0x03, 0x00, 0x0c,
   0x03, 0x00, 0x0c, 0x03, 0x00, 0x0c, 0xff, 0xff, 0x0f, 0xfe, 0xff, 0x07 };


#define light_footer_logo_energan_spb_width 128
#define light_footer_logo_energan_spb_height 35
static unsigned char light_footer_logo_energan_spb_bits[] = {
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x7e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xff, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0x0f, 0xf0,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0xd8, 0x17, 0xe0, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0xf0, 0x37, 0xe0, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7d, 0xe0,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x70, 0xbe, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0xf0, 0xff, 0xf0, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xfe, 0xff, 0x70,
   0xe0, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0xff, 0xff, 0x79, 0xf8, 0x87, 0x01, 0xe7, 0xff, 0xfc, 0x8f, 0xff,
   0xc3, 0x03, 0x07, 0x0e, 0x80, 0xef, 0xff, 0x38, 0xfe, 0x8f, 0x01, 0xe7,
   0xff, 0xfc, 0x9f, 0xff, 0xc3, 0x07, 0x07, 0x0e, 0x80, 0xf3, 0xff, 0x3d,
   0x1c, 0x9e, 0x01, 0xe7, 0x00, 0x1c, 0xbc, 0x03, 0xe0, 0x07, 0x07, 0x0e,
   0xc0, 0xf7, 0xff, 0x1e, 0x00, 0x9c, 0xff, 0xe7, 0x1f, 0x0c, 0xb8, 0x03,
   0xe0, 0x0e, 0xff, 0x0f, 0xc0, 0xff, 0x7f, 0x0e, 0xc0, 0xbf, 0xff, 0xe7,
   0x1f, 0xfc, 0x9f, 0x03, 0x70, 0x0e, 0xff, 0x0f, 0x80, 0xff, 0x7f, 0x0f,
   0xc0, 0xbf, 0xff, 0xe7, 0x1f, 0xfc, 0x9f, 0x03, 0xf0, 0x1f, 0xff, 0x0f,
   0x00, 0xff, 0x9c, 0x0f, 0x0c, 0x9c, 0x01, 0xe7, 0x00, 0xfc, 0x87, 0x03,
   0xf8, 0x1f, 0x07, 0x0e, 0x00, 0x7f, 0xc8, 0x07, 0x3e, 0x9f, 0x01, 0xe7,
   0x80, 0x0c, 0x80, 0x03, 0xf8, 0x3f, 0x07, 0x0e, 0x00, 0x3f, 0xe0, 0x05,
   0xfc, 0x8f, 0x01, 0xe7, 0xff, 0x0c, 0x80, 0x03, 0x1c, 0x78, 0x07, 0x0e,
   0x00, 0x3e, 0xf0, 0x06, 0xf8, 0x83, 0x01, 0xe7, 0xff, 0x0c, 0x80, 0x03,
   0x1e, 0x70, 0x07, 0x0e, 0x20, 0x1e, 0x78, 0x02, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x1e, 0x3c, 0x01,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x30, 0x0c, 0x1f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x30, 0x88, 0x0f, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0xe0, 0x17, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x80, 0x00,
   0x70, 0xfc, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x08, 0x00, 0xf0, 0x7f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf0, 0x3f, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0xe0, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };

#define i_width 133
#define i_height 64
static unsigned char i_bits[] = {
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x10, 0x00, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x10, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x61, 0x0c,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x48, 0x00, 0x00, 0x02, 0x00,
   0x00, 0x00, 0x40, 0x92, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00,
   0x61, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x42, 0x12, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x10, 0x00, 0x30, 0x00, 0x00, 0x0a, 0x00, 0x00, 0x00,
   0x00, 0x41, 0x12, 0x20, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x60, 0x00,
   0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x81, 0x12, 0x00, 0x00, 0x00, 0xb0,
   0x02, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x98,
   0x12, 0x00, 0x00, 0x00, 0x40, 0x02, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0xc0, 0x73, 0x0c, 0x00, 0x00, 0x00, 0x58, 0x02, 0x10,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x10, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x2c, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00,
   0x51, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x21, 0x0c, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x10, 0x00, 0x02, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00,
   0x40, 0x52, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x08, 0x00,
   0x00, 0x04, 0x00, 0x00, 0x00, 0x00, 0x42, 0x12, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x10, 0x00, 0x49, 0x00, 0x40, 0x08, 0x00, 0x00, 0x00, 0x00, 0x43,
   0x12, 0x20, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x12, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x80, 0x80, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xd0, 0x12, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0xc0, 0x27, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xa0, 0x00,
   0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x40, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xa0, 0x00, 0x10, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x40, 0x00, 0x10, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0xfe, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10,
   0x00, 0x10, 0x00, 0x04, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x21,
   0x0c, 0x00, 0x00, 0x00, 0x40, 0x01, 0x10, 0x80, 0x84, 0x00, 0x00, 0x02,
   0x00, 0x00, 0x00, 0x40, 0x52, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10,
   0x80, 0x80, 0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x42, 0x12, 0x00,
   0x00, 0x00, 0xa0, 0x00, 0x10, 0x00, 0xb7, 0x00, 0x00, 0x0a, 0x00, 0x00,
   0x00, 0x00, 0x42, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00,
   0x00, 0x08, 0x00, 0x00, 0x00, 0x00, 0x80, 0x81, 0x12, 0x20, 0x00, 0x00,
   0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80,
   0x90, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0xc0, 0x73, 0x0c, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x06, 0x10,
   0x00, 0xe0, 0x1c, 0x00, 0x00, 0x00, 0x00, 0x80, 0x03, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x40, 0x10, 0x10, 0x00, 0xe0, 0x1c, 0x00, 0x00, 0x00, 0x00,
   0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x40,
   0x1c, 0x00, 0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x10, 0x40, 0x10, 0x40, 0xd5, 0x1a, 0x00, 0x00, 0x00, 0x00, 0x70, 0x00,
   0x00, 0x00, 0x00, 0x00, 0xa0, 0x88, 0x00, 0x10, 0xe0, 0xff, 0x1b, 0x00,
   0x00, 0x00, 0x00, 0x1c, 0xa0, 0x00, 0x00, 0x00, 0x00, 0xd0, 0x4a, 0x81,
   0x10, 0xe0, 0x00, 0xdb, 0xff, 0xff, 0xff, 0xff, 0x1b, 0xa0, 0xff, 0xff,
   0xff, 0xff, 0xd7, 0x08, 0x22, 0x10, 0xe0, 0xff, 0x5b, 0x55, 0x55, 0x55,
   0x55, 0x0b, 0xa0, 0x55, 0x55, 0x55, 0x55, 0xd5, 0x0a, 0x90, 0x10, 0xe0,
   0xfb, 0x1b, 0x00, 0x00, 0x00, 0x00, 0x04, 0x20, 0x00, 0x00, 0x00, 0x00,
   0xa0, 0x08, 0x00, 0x10, 0xe0, 0xf9, 0x1b, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0xa0, 0x10, 0x40, 0x10, 0xe1, 0xf9, 0x1b,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x20, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x40, 0x18, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0x10,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00,
   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
   0x00, 0x00, 0x10, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
   0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x1f };



#define LCD_DATA_BUFFER_SIZE 1024

static u8g2_t u8g2;
static uint8_t LCD_REDRAW_FLAG = 0;

static SemaphoreHandle_t  xSemaphore = NULL;

//Функция инициализации драйвера LCD
void vLCDInit(SemaphoreHandle_t temp)
{
	 xSemaphore = temp;
	 return;
}



extern TIM_HandleTypeDef htim7;
extern SPI_HandleTypeDef hspi1;

static uint8_t LCD_Buffer[LCD_DATA_BUFFER_SIZE];

//Процедура обновления индикатора
void LCD_Redraw( void )
{
	uint16_t i=0;
	uint8_t  x, y, c, j;
	uint8_t *ptr;

	for ( i=0U; i<LCD_DATA_BUFFER_SIZE;i ++ )
	{
		if ( LCD_Buffer[i] != u8g2.tile_buf_ptr[i] )
		{
			LCD_Buffer[i]		= u8g2.tile_buf_ptr[i];
			LCD_REDRAW_FLAG = 1U;
		}
	}
	if ( LCD_REDRAW_FLAG == 1U )
	{
	  HAL_GPIO_WritePin( LCD_CS_GPIO_Port, LCD_CS_Pin, GPIO_PIN_SET );
	  LCD_WriteCommand( 0x3EU );
	  for ( i=0U; i<8U; i++ )
	  {
		  y = i;
		  y*= 8U;
		  x = 0U;
		  if ( y >= 32U )	/* this is the adjustment for 128x64 displays */
		  {
		  	  y -= 32U;
		  	  x += 8U;
		  }
		  ptr = &LCD_Buffer[i * 128U];	/* data ptr to the tiles */
		  for( j=0U; j<8U; j++ )
		  {
		  	  LCD_WriteCommand( 0x080U | (y+j) );
		  	  LCD_WriteCommand( 0x080U | x);
		   	  LCD_Send16Data(ptr);
		   	  ptr += 16U;
		  }
	  }
	  HAL_GPIO_WritePin( LCD_CS_GPIO_Port, LCD_CS_Pin, GPIO_PIN_RESET );
      LCD_REDRAW_FLAG == 0U;	// Что это???
	}
	return;
}


void StartLcdRedrawTask(void *argument)
{
  /* USER CODE BEGIN StartLCDRedraw */
  /* Infinite loop */
  for(;;)
  {
    osDelay( 200U );
    LCD_Redraw();
  }
  /* USER CODE END StartLCDRedraw */
}




void LCD_Clear( void )
{
 LCD_WriteCommand( 0x38U );
 LCD_WriteCommand( 0x01U );
 osDelay( 2U );
 return;
}

//LCD Write Command
inline void LCD_WriteCommand( uint8_t com )
{
	uint8_t Data[3U];
	Data[0U] = 0xF8U;
	Data[1U] = 0xF0U & com;
  Data[2U] = 0xF0U & ( com << 4U );
  HAL_SPI_Transmit_DMA( &hspi1, &Data, 3U );
  HAL_TIM_Base_Start_IT( &htim7 );
  xSemaphoreTake( xSemaphore, portMAX_DELAY );
  return;
}


void LCD_Delay( void )
{
  static portBASE_TYPE xHigherPriorityTaskWoken;

  if ( hspi1.State != HAL_SPI_STATE_BUSY_TX )
  {
	  HAL_TIM_Base_Stop_IT( &htim7 );
	  xHigherPriorityTaskWoken = pdFALSE;
	  xSemaphoreGiveFromISR( xSemaphore, &xHigherPriorityTaskWoken );
	  portEND_SWITCHING_ISR( xHigherPriorityTaskWoken )
  }
  return;
}

inline void LCD_Send16Data( uint8_t *arg_prt )
{
	  uint8_t *data;
	  uint8_t b;
	  uint8_t i;
	  uint8_t Data[33U];

	  Data[0U] = 0xFAU;
	  data = (uint8_t *)arg_prt;
	  for ( i=0U; i<16U; i++ )
	  {
	   b = *data++;
	   Data[i * 2U + 1U]= b & 0x0f0U;
	   Data[i * 2U + 2U]= b << 4U;
	  }
	  HAL_SPI_Transmit_DMA( &hspi1, &Data, 33U );
	  HAL_TIM_Base_Start_IT( &htim7 );
	  xSemaphoreTake( xSemaphore, portMAX_DELAY );
}
//LCD Reset
void LCD_Reset( void )
{
	HAL_GPIO_WritePin( LCD_RST_GPIO_Port, LCD_RST_Pin, GPIO_PIN_SET );
	osDelay( 10U );
	HAL_GPIO_WritePin( LCD_RST_GPIO_Port, LCD_RST_Pin, GPIO_PIN_RESET );
	osDelay( 10U );
	HAL_GPIO_WritePin( LCD_RST_GPIO_Port, LCD_RST_Pin, GPIO_PIN_SET );
	osDelay( 600U );
	return;
}

uint8_t u8x8_stm32_gpio_and_delay( U8X8_UNUSED u8x8_t *u8x8,
																	 U8X8_UNUSED uint8_t msg,
																	 U8X8_UNUSED uint8_t arg_int,
																	 U8X8_UNUSED void *arg_ptr )
{
  switch ( msg )
  {
  	case U8X8_MSG_DELAY_MILLI:
  		HAL_Delay( arg_int );
  		break;
  	case U8X8_MSG_DELAY_100NANO:
  		__asm__( "nop" );
      break;
  	case U8X8_MSG_GPIO_DC:
  		HAL_GPIO_WritePin( LCD_CS_GPIO_Port, LCD_CS_Pin, arg_int );
  		break;
  	case U8X8_MSG_GPIO_RESET:
  		// HAL_GPIO_WritePin( LCD_CS_GPIO_Port, LCD_CS_Pin, arg_int);
  		break;
  }
  return 1U;
}

uint8_t u8x8_byte_STM_spi( u8x8_t *u8x8, uint8_t msg, uint8_t arg_int,
    void *arg_ptr )
{
	uint8_t res = 0U;

  switch ( msg )
  {
  	case U8X8_MSG_BYTE_SEND:
  		HAL_SPI_Transmit(&hspi1, (uint8_t *) arg_ptr, arg_int, 10000);
  		// Delay1us(72);
  		break;
  	case U8X8_MSG_BYTE_INIT:
  		HAL_GPIO_WritePin( LCD_CS_GPIO_Port, LCD_CS_Pin, arg_int );
  		break;
  	case U8X8_MSG_BYTE_SET_DC:
  		HAL_GPIO_WritePin( LCD_CS_GPIO_Port, LCD_CS_Pin, arg_int );
  		break;
  	case U8X8_MSG_BYTE_START_TRANSFER:
  		HAL_GPIO_WritePin( LCD_CS_GPIO_Port, LCD_CS_Pin, GPIO_PIN_SET );
  		break;
  	case U8X8_MSG_BYTE_END_TRANSFER:
  		HAL_GPIO_WritePin( LCD_CS_GPIO_Port, LCD_CS_Pin, GPIO_PIN_RESET );
  		break;
  	default:
  		res = 0U;
  		break;
  }
  res = 1U;
  return res;
}

static char str[2]={ '0' , 0U };
void vLCD_Init()
{
	u8g2_Setup_st7920_s_128x64_f( &u8g2, U8G2_R0, u8x8_byte_STM_spi, u8x8_stm32_gpio_and_delay );
  u8g2_InitDisplay( &u8g2 );
  u8g2_SetPowerSave( &u8g2, 0U );
  return;
}

static uint8_t x = 10U;
static uint8_t y = 10U;
static uint8_t x_dir = 0U;
static uint8_t y_dir = 0U;
static uint8_t demo_step = 22U, dl = 0U, SS = 0U;
void IncData( void )
{
	/*u8g2_font_4x6_t_cyrillic
	u8g2_font_5x7_t_cyrillic
	u8g2_font_5x8_t_cyrillic
	u8g2_font_6x12_t_cyrillic
	u8g2_font_6x13_t_cyrillic
	u8g2_font_6x13B_t_cyrillic
	u8g2_font_7x13_t_cyrillic
	u8g2_font_8x13_t_cyrillic
	u8g2_font_9x15_t_cyrillic
	u8g2_font_10x20_t_cyrillic
	u8g2_font_cu12_t_cyrillic
	u8g2_font_unifont_t_cyrillic
	u8g2_font_haxrcorp4089_t_cyrillic
	u8g2_font_inr24_t_cyrillic
	u8g2_font_inr27_t_cyrillic
	u8g2_font_inr30_t_cyrillic
	u8g2_font_inr33_t_cyrillic
	u8g2_font_inr38_t_cyrillic
	u8g2_font_inr42_t_cyrillic
	u8g2_font_inr46_t_cyrillic
	u8g2_font_inr49_t_cyrillic
	u8g2_font_inr53_t_cyrillic
	*/

	//Демонтсрация шрифтов.
	u8g2_ClearBuffer(&u8g2);
	switch (demo_step)
	{
		case 1:
			break;
		case 2:
			break;
		case 3:
			u8g2_SetDrawColor( &u8g2, 1U );
			u8g2_SetFont( &u8g2, u8g2_font_6x12_te );
			u8g2_DrawUTF8( &u8g2, 0U, 10U, "font_4x6" );
			u8g2_SetFont( &u8g2, u8g2_font_4x6_t_cyrillic );
			u8g2_DrawUTF8( &u8g2, 0U, 20U, "Ф Ж Щ ф ж щ ш 123456dtr" );
			u8g2_SetFont( &u8g2, u8g2_font_6x12_te );
			u8g2_DrawUTF8( &u8g2, 0U, 30U, "font_5x7" );
			u8g2_SetFont( &u8g2, u8g2_font_5x7_t_cyrillic );
			u8g2_DrawUTF8( &u8g2, 0U, 40U, "Ф Ж Щ ф ж щ ш 123456drt" );
			u8g2_SetFont( &u8g2, u8g2_font_6x12_te );
			u8g2_DrawUTF8( &u8g2, 0U, 50U, "font_5x8" );
			u8g2_SetFont( &u8g2, u8g2_font_5x8_t_cyrillic );
     	u8g2_DrawUTF8( &u8g2, 0U, 60U, "Ф Ж Щ ф ж щ ш 123456dtr" );
			break;
		case 4:
			break;
	  case 5:
	  	break;
	  case 6:
			u8g2_SetDrawColor (&u8g2, 1U );
			u8g2_SetFont( &u8g2, u8g2_font_6x12_te );
			u8g2_DrawUTF8( &u8g2, 0U, 10U, "font_6x12" );
			u8g2_SetFont( &u8g2, u8g2_font_6x12_t_cyrillic );
			u8g2_DrawUTF8( &u8g2, 0U, 20U, "ФЖЩфжщш 123drt" );
			u8g2_SetFont( &u8g2, u8g2_font_6x12_te );
			u8g2_DrawUTF8( &u8g2, 0U, 30U, "font_6x13" );
			u8g2_SetFont( &u8g2, u8g2_font_6x13_t_cyrillic );
			u8g2_DrawUTF8( &u8g2, 0U, 40U, "ФЖЩфжщш 123drt" );
			u8g2_SetFont( &u8g2, u8g2_font_6x12_te );
			u8g2_DrawUTF8( &u8g2, 0U, 52U, "font_6x13b" );
			u8g2_SetFont( &u8g2, u8g2_font_6x13B_t_cyrillic );
			u8g2_DrawUTF8( &u8g2, 0U, 62U, "ФЖЩфжщш 123drt" );
			break;
		case 7:
			break;
		case 8:
			break;
		case 9:
			u8g2_SetDrawColor( &u8g2, 1U );
			u8g2_SetFont( &u8g2, u8g2_font_6x12_te );
			u8g2_DrawUTF8( &u8g2, 0U, 10U, "font_7x13" );
			u8g2_SetFont( &u8g2, u8g2_font_7x13_t_cyrillic );
			u8g2_DrawUTF8( &u8g2, 0U, 20U, "ФЖЩфжщш" );
			u8g2_SetFont( &u8g2, u8g2_font_6x12_te );
			u8g2_DrawUTF8( &u8g2, 0U, 30U, "font_8x13" );
			u8g2_SetFont( &u8g2, u8g2_font_8x13_t_cyrillic );
			u8g2_DrawUTF8( &u8g2, 0U, 40U, "ФЖЩфжщш1234567890-квпкы" );
			u8g2_SetFont( &u8g2, u8g2_font_6x12_te );
			u8g2_DrawUTF8( &u8g2, 0U, 52U, "font_9x15" );
			u8g2_SetFont( &u8g2, u8g2_font_9x15_t_cyrillic );
			u8g2_DrawUTF8( &u8g2, 0U, 63U, "ФЖЩфжщш" );
			break;
		case 10:
			break;
		case 11:
			break;
		case 12:
			u8g2_SetDrawColor( &u8g2, 1U );
			u8g2_SetFont( &u8g2, u8g2_font_6x12_te );
			u8g2_DrawUTF8( &u8g2, 0U, 12U, "font_10x20" );
			u8g2_SetFont( &u8g2, u8g2_font_10x20_t_cyrillic );
			u8g2_DrawUTF8( &u8g2, 0U, 30U, "ФЖЩфжщш 123" );
			u8g2_SetDrawColor( &u8g2, 1U );
			u8g2_SetFont( &u8g2, u8g2_font_6x12_te );
			u8g2_DrawUTF8( &u8g2, 0U, 42U, "font_cur12" );
			u8g2_SetFont( &u8g2, u8g2_font_cu12_t_cyrillic );
			u8g2_DrawUTF8( &u8g2, 0U, 60U, "ФЖЩфжщш 123" );
			break;
		case 13:
			break;
		case 14:
			u8g2_SetDrawColor( &u8g2, 1U );
			u8g2_SetFont( &u8g2, u8g2_font_6x12_te );
			u8g2_DrawUTF8( &u8g2, 0U, 7U, "font_unifont" );
			u8g2_SetFont( &u8g2, u8g2_font_unifont_t_cyrillic );
			u8g2_DrawUTF8( &u8g2, 0U, 20U, "ФЖЩфжщш 123try" );
			u8g2_SetFont( &u8g2, u8g2_font_6x12_te );
			u8g2_DrawUTF8( &u8g2, 0U, 30U, "font_inr24" );
			u8g2_SetFont( &u8g2, u8g2_font_inr24_t_cyrillic );
			u8g2_DrawUTF8( &u8g2, 0U, 60U, "ФЖЩфж" );
			break;
		case 15:
			break;
		case 16:
			u8g2_SetDrawColor( &u8g2, 1U );
			u8g2_SetFont( &u8g2, u8g2_font_6x12_te );
			u8g2_DrawUTF8( &u8g2, 0U, 12U, "font_inr27" );
			u8g2_SetFont( &u8g2, u8g2_font_inr27_t_cyrillic );
			u8g2_DrawUTF8( &u8g2, 0U, 55U, "фжщш" );
			break;
		case 17:
			break;
		case 18:
			break;
		case 19:
			u8g2_SetDrawColor( &u8g2, 1U );
			u8g2_SetBitmapMode (&u8g2, 1U );
			u8g2_DrawXBM( &u8g2, 0U, 0U, light_footer_logo_energan_spb_width, light_footer_logo_energan_spb_height, light_footer_logo_energan_spb_bits );
			if ( SS == 0U )
			{
				u8g2_DrawRBox( &u8g2, 19U, 36U, 22U, 22U, 3U );
			}
			else
			{
				u8g2_DrawRFrame( &u8g2, 19U, 36U, 22U, 22U, 3U );
			}
			u8g2_SetDrawColor( &u8g2, SS==0U?0U:1U );
			u8g2_DrawXBM( &u8g2, 20U, 37U, icons8_width, icons8_height, icons8_bits );
			u8g2_SetDrawColor( &u8g2, 1U );
			if ( SS == 1U )
			{
				u8g2_DrawRBox( &u8g2, 55U, 36U, 22U, 22U, 3U );
			}
			else
			{
				u8g2_DrawRFrame( &u8g2, 55U, 36U, 22U, 22U, 3U );
			}
			u8g2_SetDrawColor( &u8g2, SS==1U?0U:1U);
			u8g2_DrawXBM( &u8g2, 56U, 37U, icons8_width, icons8_height, icons8_1_bits );
			u8g2_SetDrawColor( &u8g2, 1U );
			if ( SS == 2U )
			{
				u8g2_DrawRBox( &u8g2, 89U, 36U, 22U, 22U, 3U );
			}
			else
			{
				u8g2_DrawRFrame( &u8g2, 89U, 36U, 22U, 22U, 3U );
			}
			u8g2_SetDrawColor( &u8g2, SS==2U?0U:1U );
			u8g2_DrawXBM( &u8g2, 90U, 37U, icons8_width, icons8_height, icons8_2_bits );
			SS++;
			if ( SS == 3U )
			{
				SS = 0U;
			}
			break;
		case 20:
			break;
		case 21:
			break;
		case 22:
			u8g2_SetDrawColor( &u8g2, 1U );
			u8g2_SetBitmapMode( &u8g2, 1U );
			if ( SS == 0U )
			{
				u8g2_DrawRBox( &u8g2, 0U, 0U, 20U, 20U, 3U );
			}
			u8g2_SetDrawColor( &u8g2, SS==0U?0U:1U );
			u8g2_DrawXBM( &u8g2, 0U, 0U, icons8_height, icons8_height, home_bits );
			u8g2_SetDrawColor( &u8g2, 1U );
			if ( SS == 1U )
			{
				u8g2_DrawRBox( &u8g2, 0U, 21U, 20U, 20U, 3U);
			}
			u8g2_SetDrawColor( &u8g2, SS==1U?0U:1U );
			u8g2_DrawXBM( &u8g2, 0U, 21U, icons8_width, icons8_height, icons8_1_bits );
			if ( SS == 2U )
			{
				u8g2_DrawRBox( &u8g2, 0U, 41U, 20U, 20U, 3U );
			}
			u8g2_SetDrawColor( &u8g2, SS==2U?0U:1U );
			u8g2_DrawXBM( &u8g2, 0U, 41U, icons8_width, icons8_height, icons8_2_bits );
			if ( SS == 3U )
			{
				u8g2_DrawRBox( &u8g2, 106U, 0U, 20U, 20U, 3U );
			}
			u8g2_SetDrawColor( &u8g2, SS==3U?0U:1U );
			u8g2_DrawXBM( &u8g2, 106U, 0U, icons8_width, icons8_height, icons8_bits );
			if ( SS == 4U )
			{
				u8g2_DrawRBox( &u8g2, 106U, 21U, 20U, 20U, 3U );
			}
			u8g2_SetDrawColor( &u8g2, SS==4U?0U:1U );
			u8g2_DrawXBM( &u8g2, 106U, 21U, icons8_width, icons8_height, akk_bits );
			u8g2_SetDrawColor( &u8g2, 1U );
			u8g2_DrawXBM( &u8g2, 60U, 42U, icons8_width, icons8_height, fac_bits );
			u8g2_SetFont( &u8g2, u8g2_font_6x13_t_cyrillic );
			u8g2_DrawUTF8( &u8g2, 22U, 12U, "время" );
			u8g2_DrawUTF8( &u8g2, 21U, 37U, "напряжение   v" );
			u8g2_SetFont( &u8g2, u8g2_font_5x8_t_cyrillic );
			//u8g2_DrawUTF8(&u8g2, 61, 12, "12:54:12");
			char time[9] = {' ',' ',' ',' ',' ',' ',' ',' ',' '};
			eRTCgetTime( time );
			u8g2_DrawUTF8( &u8g2, 61U, 12U, time );
			char ipStr[16];
			cSERVERgetStrIP( ipStr );
			u8g2_DrawUTF8( &u8g2, 26U, 25U, ipStr );

			u8g2_DrawUTF8( &u8g2, 84U, 37U, "200" );
			SS++;
			if ( SS == 5U )
			{
				SS = 0U;
			}
			break;
		default:
			demo_step = 0U;
			break;
	}
	//demo_step++;




	//u8g2_DrawCircle(&u8g2, x, y, 10, U8G2_DRAW_ALL);


	/*if (x_dir==0)
		x++;
	else
		x--;
    if (x>=128-10) x_dir=1;
	if (x<=10) x_dir=0;

	if (y_dir==0)
			y++;
		else
			y--;
	if (y>=64-10) y_dir=1;
	if (y<=10) y_dir=0;
*/


}





